{"remainingRequest":"/home/linjiashop/linjiashop-mobile/node_modules/thread-loader/dist/cjs.js!/home/linjiashop/linjiashop-mobile/node_modules/babel-loader/lib/index.js!/home/linjiashop/linjiashop-mobile/src/view/goods/goods.js?vue&type=script&lang=js&external","dependencies":[{"path":"/home/linjiashop/linjiashop-mobile/src/view/goods/goods.js","mtime":1701070142211},{"path":"/home/linjiashop/linjiashop-mobile/babel.config.js","mtime":1701070142207},{"path":"/home/linjiashop/linjiashop-mobile/node_modules/cache-loader/dist/cjs.js","mtime":1701139867369},{"path":"/home/linjiashop/linjiashop-mobile/node_modules/thread-loader/dist/cjs.js","mtime":1701139866811},{"path":"/home/linjiashop/linjiashop-mobile/node_modules/babel-loader/lib/index.js","mtime":1701139868485}],"contextDependencies":[],"result":["import \"vant/es/toast/style\";\nimport _Toast from \"vant/es/toast\";\nimport \"core-js/modules/es6.regexp.split\";\nimport _defineProperty from \"/home/linjiashop/linjiashop-mobile/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty.js\";\nimport \"vant/es/button/style\";\nimport _Button from \"vant/es/button\";\nimport \"vant/es/sku/style\";\nimport _Sku from \"vant/es/sku\";\nimport \"vant/es/tabbar-item/style\";\nimport _TabbarItem from \"vant/es/tabbar-item\";\nimport \"vant/es/tabbar/style\";\nimport _Tabbar from \"vant/es/tabbar\";\nimport \"vant/es/goods-action-button/style\";\nimport _GoodsActionButton from \"vant/es/goods-action-button\";\nimport \"vant/es/goods-action-icon/style\";\nimport _GoodsActionIcon from \"vant/es/goods-action-icon\";\nimport \"vant/es/goods-action/style\";\nimport _GoodsAction from \"vant/es/goods-action\";\nimport \"vant/es/swipe-item/style\";\nimport _SwipeItem from \"vant/es/swipe-item\";\nimport \"vant/es/swipe/style\";\nimport _Swipe from \"vant/es/swipe\";\nimport \"vant/es/cell-group/style\";\nimport _CellGroup from \"vant/es/cell-group\";\nimport \"vant/es/cell/style\";\nimport _Cell from \"vant/es/cell\";\nimport \"vant/es/icon/style\";\nimport _Icon from \"vant/es/icon\";\nimport \"vant/es/col/style\";\nimport _Col from \"vant/es/col\";\nimport \"vant/es/tag/style\";\nimport _Tag from \"vant/es/tag\";\nvar _components;\nimport goods from '@/api/goods';\nimport cart from '@/api/cart';\nimport favorite from '@/api/favorite';\nimport storage from '@/utils/storage';\nvar baseApi = process.env.VUE_APP_BASE_API;\nexport default {\n  components: (_components = {}, _defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_components, _Tag.name, _Tag), _Col.name, _Col), _Icon.name, _Icon), _Cell.name, _Cell), _CellGroup.name, _CellGroup), _Swipe.name, _Swipe), _SwipeItem.name, _SwipeItem), _GoodsAction.name, _GoodsAction), _GoodsActionIcon.name, _GoodsActionIcon), _GoodsActionButton.name, _GoodsActionButton), _defineProperty(_defineProperty(_defineProperty(_defineProperty(_components, _Tabbar.name, _Tabbar), _TabbarItem.name, _TabbarItem), _Sku.name, _Sku), _Button.name, _Button)),\n  data: function data() {\n    return {\n      ifLike: false,\n      likeColor: 'black',\n      cartCount: '',\n      showSku: false,\n      sku: {\n        tree: [],\n        list: [],\n        price: '0',\n        // 默认价格（单位元）\n        stock_num: 20,\n        // 商品总库存\n        collection_id: 0,\n        // 无规格商品 skuId 取 collection_id，否则取所选 sku 组合对应的 id\n        none_sku: false,\n        // 是否无规格商品\n        hide_stock: false // 是否隐藏剩余库存\n      },\n\n      offline: false,\n      goods: {\n        name: '',\n        price: 0,\n        express: '免运费',\n        remain: 0,\n        thumb: []\n      }\n    };\n  },\n  created: function created() {\n    this.init();\n  },\n  computed: {},\n  methods: {\n    init: function init() {\n      var _this = this;\n      var id = this.$route.params.id;\n      goods.getGoods(id).then(function (response) {\n        var goods = response.data.goods;\n        _this.offline = !goods.isOnSale;\n        var sku = response.data.sku;\n        sku.price = (sku.price / 100).toFixed(2);\n        _this.sku = sku;\n        goods.thumb = new Array();\n        goods.picture = baseApi + '/file/getImgStream?idFile=' + goods.pic;\n        var gallery = goods.gallery.split(',');\n        for (var index in gallery) {\n          goods.thumb.push(baseApi + '/file/getImgStream?idFile=' + gallery[index]);\n        }\n        _this.goods = goods;\n        var user = storage.getUser();\n        if (user.nickName) {\n          //获取当前用户购物车商品数量\n          cart.count().then(function (response) {\n            _this.cartCount = response.data === 0 ? '' : response.data;\n          }).catch(function (err) {});\n          //判断当前用户是否收藏该产品\n          favorite.ifLike(_this.goods.id).then(function (response) {\n            if (response.data === true) {\n              _this.likeColor = 'red';\n              _this.ifLike = true;\n            }\n          }).catch(function (err) {});\n        }\n      }).catch(function (err) {\n        console.log('err', err);\n        _Toast(err);\n      });\n    },\n    toHome: function toHome() {\n      this.$router.push('/index');\n    },\n    formatPrice: function formatPrice() {\n      return '¥' + (this.goods.price / 100).toFixed(2);\n    },\n    goToCart: function goToCart() {\n      this.$router.push('/cart');\n    },\n    addCart: function addCart() {\n      this.showSku = true;\n    },\n    buy: function buy() {\n      this.showSku = true;\n    },\n    sorry: function sorry() {\n      _Toast('敬请期待');\n    },\n    like: function like() {\n      var _this2 = this;\n      if (this.ifLike === false) {\n        favorite.add(this.goods.id).then(function (response) {\n          _Toast('收藏成功');\n          _this2.ifLike = true;\n          _this2.likeColor = 'red';\n        });\n      } else {\n        favorite.dislike(this.goods.id).then(function (response) {\n          _Toast('取消收藏成功');\n          _this2.ifLike = false;\n          _this2.likeColor = 'black';\n        });\n      }\n    },\n    onBuyClicked: function onBuyClicked(skuData) {\n      var _this3 = this;\n      var cartData = {\n        idGoods: skuData.goodsId,\n        idSku: this.sku.none_sku ? '' : skuData.selectedSkuComb.id,\n        count: skuData.selectedNum\n      };\n      cart.add(cartData).then(function (response) {\n        _this3.$router.push('/cart');\n        _this3.showSku = false;\n      });\n    },\n    onAddCartClicked: function onAddCartClicked(skuData) {\n      var _this4 = this;\n      var cartData = {\n        idGoods: skuData.goodsId,\n        idSku: this.sku.none_sku ? '' : skuData.selectedSkuComb.id,\n        count: skuData.selectedNum\n      };\n      cart.add(cartData).then(function (response) {\n        console.log(response);\n        _Toast.success('已加入到购物车');\n        _this4.showSku = false;\n        _this4.cartCount += response.data;\n      });\n    }\n  }\n};",null]}