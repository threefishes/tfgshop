(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-517ba433"],{"7ded":function(e,t,a){"use strict";var n=a("b775");t["a"]={loginOrReg:function(e,t){return Object(n["a"])({url:"/loginOrReg",method:"post",params:{mobile:e,smsCode:t}})},loginByPassword:function(e,t){return Object(n["a"])({url:"/loginByPass",method:"post",params:{mobile:e,password:t}})},sendSmsCode:function(e){return Object(n["a"])({url:"/sendSmsCode",method:"post",params:{mobile:e}})},logout:function(){return Object(n["a"])({url:"/logout",method:"post"})}}},8447:function(e,t,a){"use strict";a("ff4e")},9354:function(e,t,a){"use strict";a.r(t);var n,r=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"setting"},[t("van-nav-bar",{attrs:{title:"设置","left-arrow":""},on:{"click-left":e.onClickLeft}}),e._v(" "),t("van-cell-group",[t("van-cell",{attrs:{icon:"flower-o",title:"头像","is-link":"",to:"avatar"}},[t("van-image",{attrs:{round:"",width:"30",height:"30",src:e.avatarUrl}})],1),e._v(" "),t("van-cell",{attrs:{icon:"user-o",title:"姓名",value:e.user.nickName,"is-link":"",to:"updateUserName"}}),e._v(" "),t("van-cell",{attrs:{icon:"share",title:"性别","is-link":"",value:e.user.genderStr},on:{click:function(t){e.showGender=!0}}}),e._v(" "),t("van-cell",{attrs:{icon:"closed-eye",title:"修改密码","is-link":"",to:"updatePwd"}}),e._v(" "),t("van-cell",{attrs:{icon:"phone-o",title:"更换手机","is-link":"",to:"updateMobile"}}),e._v(" "),t("van-cell",{attrs:{icon:"warning-o",title:"关于本项目","is-link":"",url:"http://linjiashop.enilu.cn/linjiashop/"}})],1),e._v(" "),t("div",{staticClass:"logout"},[t("van-button",{attrs:{type:"danger",plain:"",round:"",block:""},on:{click:e.onLogout}},[e._v("退出登录")])],1),e._v(" "),t("van-popup",{style:{padding:"20px",width:"50px",height:"50px"},model:{value:e.showGender,callback:function(t){e.showGender=t},expression:"showGender"}},[t("van-radio-group",{on:{change:e.onChangeGender},model:{value:e.user.gender,callback:function(t){e.$set(e.user,"gender",t)},expression:"user.gender"}},[t("van-radio",{attrs:{name:"male"}},[e._v("男")]),e._v(" "),t("van-radio",{attrs:{name:"female"}},[e._v("女")])],1)],1)],1)},s=[],o=a("bd86"),i=(a("4ddd"),a("9f14")),u=(a("a44c"),a("e27c")),c=(a("8a58"),a("e41f")),d=(a("4056"),a("44bf")),l=(a("e7e5"),a("d399")),p=(a("5246"),a("6b41")),g=(a("0653"),a("34e9")),h=(a("c194"),a("7744")),m=(a("c3a6"),a("ad06")),f=(a("81e6"),a("9ffb")),b=(a("66b9"),a("b650")),v=(a("4d48"),a("d1e1")),j=a("7ded"),O=a("c24f"),k=a("4360"),w=a("5d2d"),U="/prod-api",_={components:(n={},Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])(n,v["a"].name,v["a"]),b["a"].name,b["a"]),f["a"].name,f["a"]),m["a"].name,m["a"]),h["a"].name,h["a"]),g["a"].name,g["a"]),p["a"].name,p["a"]),l["a"].name,l["a"]),d["a"].name,d["a"]),c["a"].name,c["a"]),Object(o["a"])(Object(o["a"])(n,u["a"].name,u["a"]),i["a"].name,i["a"])),store:k["a"],data:function(){return{avatarUrl:"http://linjiashop.enilu.cn/linjiashop/logo.jpg",user:{},showGender:!1}},mounted:function(){this.init()},methods:{init:function(){this.user=w["a"].getUser(),this.user.avatar?this.avatarUrl=U+"/file/getImgStream?idFile="+this.user.avatar:this.user.wechatHeadImgUrl&&(this.avatarUrl=this.user.wechatHeadImgUrl)},onClickLeft:function(){this.$router.go(-1)},onChangeGender:function(e){var t=this;this.user.gender=e,this.user.genderStr="male"===e?"男":"女",O["a"].updateGender(e).then((function(e){k["a"].dispatch("app/toggleUser",t.user),t.showGender=!1}))},onLogout:function(){var e=this;j["a"].logout().then((function(t){k["a"].dispatch("app/toggleUser",{}),k["a"].dispatch("app/toggleToken",""),e.$router.push({path:"/index"})})).catch((function(e){}))}}},P=_,x=(a("8447"),a("2877")),C=Object(x["a"])(P,r,s,!1,null,null,null);t["default"]=C.exports},b775:function(e,t,a){"use strict";a("e7e5");var n=a("d399"),r=(a("a481"),a("bc3a")),s=a.n(r),o=a("41cb"),i=a("4360"),u=a("5d2d"),c=s.a.create({baseURL:"/prod-api",withCredentials:!1,timeout:15e3});c.interceptors.request.use((function(e){return u["a"].getToken()&&(e.headers["Authorization"]=u["a"].getToken()),e}),(function(e){return Promise.reject(e)})),c.interceptors.response.use((function(e){console.log("response",e),e.headers.token&&i["a"].dispatch("app/toggleToken",e.headers.token);var t=e.data;return 2e4!==t.code?Promise.reject(t.msg||"error"):t}),(function(e){if(e.response)switch(e.response.status){case 401:return i["a"].dispatch("app/toggleUser",{}),i["a"].dispatch("app/toggleToken",""),o["a"].replace({path:"/login",query:{redirect:o["a"].currentRoute.path}}),Promise.reject(e.response.data.message);case 500:if(e.response.data.message)return e.response.data.message.indexOf("relogin")>-1?(i["a"].dispatch("app/toggleUser",{}),i["a"].dispatch("app/toggleToken",""),o["a"].replace({path:"/login",query:{redirect:o["a"].currentRoute.path}}),Promise.reject(e.response.data.message)):e.response.data.message.indexOf("该手机号已经绑定其他微信号")>-1?(i["a"].dispatch("app/toggleUser",{}),i["a"].dispatch("app/toggleToken",""),n["a"].fail(e.response.data.message),o["a"].replace({path:"/login",query:{redirect:o["a"].currentRoute.path}}),Promise.reject(e.response.data.message)):(n["a"].fail(e.response.data.message),Promise.reject(e.response.data.message));break;default:return Promise.reject(e.response.data.message)}})),t["a"]=c},c24f:function(e,t,a){"use strict";var n=a("b775");t["a"]={getUserInfo:function(){return Object(n["a"])({url:"/user/getInfo",method:"get"})},updateUserName:function(e){var t={userName:e};return Object(n["a"])({url:"/user/updateUserName/",method:"post",params:t})},updatePwd:function(e){return Object(n["a"])({url:"/account/updatePwd",method:"post",params:e})},updateGender:function(e){return Object(n["a"])({url:"/user/updateGender/"+e,method:"post"})},updatePassword:function(e,t,a){return Object(n["a"])({url:"/user/updatePassword/"+e+"/"+t+"/"+a,method:"post"})},upload:function(e){return Object(n["a"])({url:"/file/upload/base64",method:"post",data:e})},sendSmsCode:function(e){return Object(n["a"])({url:"/user/sendSmsCode",method:"post",params:{mobile:e}})},getWxSign:function(e){return Object(n["a"])({url:"/user/getWxSign",method:"post",params:e})},getWxOpenId:function(e){return Object(n["a"])({url:"/user/getWxOpenId",method:"post",params:e})}}},ff4e:function(e,t,a){}}]);