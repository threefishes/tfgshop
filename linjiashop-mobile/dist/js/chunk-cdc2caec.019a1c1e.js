(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cdc2caec"],{"0fee":function(e,t,a){},2994:function(e,t,a){"use strict";a("68ef"),a("e3b3"),a("c0c2")},"2bdd":function(e,t,a){"use strict";var r=a("d282"),n=a("02de"),i=a("a8c1"),o=a("5fbe"),s=a("543e"),c=Object(r["a"])("list"),d=c[0],u=c[1],l=c[2];t["a"]=d({mixins:[Object(o["a"])((function(e){this.scroller||(this.scroller=Object(i["d"])(this.$el)),e(this.scroller,"scroll",this.check)}))],model:{prop:"loading"},props:{error:Boolean,loading:Boolean,finished:Boolean,errorText:String,loadingText:String,finishedText:String,immediateCheck:{type:Boolean,default:!0},offset:{type:[Number,String],default:300},direction:{type:String,default:"down"}},data:function(){return{innerLoading:this.loading}},updated:function(){this.innerLoading=this.loading},mounted:function(){this.immediateCheck&&this.check()},watch:{loading:"check",finished:"check"},methods:{check:function(){var e=this;this.$nextTick((function(){if(!(e.innerLoading||e.finished||e.error)){var t,a=e.$el,r=e.scroller,i=e.offset,o=e.direction;t=r.getBoundingClientRect?r.getBoundingClientRect():{top:0,bottom:r.innerHeight};var s=t.bottom-t.top;if(!s||Object(n["a"])(a))return!1;var c=!1,d=e.$refs.placeholder.getBoundingClientRect();c="up"===o?t.top-d.top<=i:d.bottom-t.bottom<=i,c&&(e.innerLoading=!0,e.$emit("input",!0),e.$emit("load"))}}))},clickErrorText:function(){this.$emit("update:error",!1),this.check()},genLoading:function(){var e=this.$createElement;if(this.innerLoading&&!this.finished)return e("div",{key:"loading",class:u("loading")},[this.slots("loading")||e(s["a"],{attrs:{size:"16"}},[this.loadingText||l("loading")])])},genFinishedText:function(){var e=this.$createElement;if(this.finished){var t=this.slots("finished")||this.finishedText;if(t)return e("div",{class:u("finished-text")},[t])}},genErrorText:function(){var e=this.$createElement;if(this.error){var t=this.slots("error")||this.errorText;if(t)return e("div",{on:{click:this.clickErrorText},class:u("error-text")},[t])}}},render:function(){var e=arguments[0],t=e("div",{ref:"placeholder",key:"placeholder",class:u("placeholder")});return e("div",{class:u(),attrs:{role:"feed","aria-busy":this.innerLoading}},["down"===this.direction?this.slots():t,this.genLoading(),this.genFinishedText(),this.genErrorText(),"up"===this.direction?this.slots():t])}})},3647:function(e,t,a){"use strict";a("68ef"),a("9d70"),a("3743"),a("1a04"),a("5c56"),a("0fee")},"3cf7":function(e,t,a){},"45e1":function(e,t,a){"use strict";a.r(t);var r,n=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",[t("van-nav-bar",{attrs:{title:"我的订单","left-arrow":""},on:{"click-left":e.onClickLeft}}),e._v(" "),t("van-tabs",{on:{click:e.clickNav},model:{value:e.activeNav,callback:function(t){e.activeNav=t},expression:"activeNav"}},e._l(e.navList,(function(e){return t("van-tab",{key:e.id,attrs:{title:e.name}})})),1),e._v(" "),t("div",{staticClass:"order_list"},[t("van-list",{attrs:{finished:e.finished,"immediate-check":!1,"finished-text":"没有更多了"},on:{load:e.getData},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.orderList,(function(a,r){return t("van-panel",{key:r,attrs:{title:"订单编号: "+a.orderSn,status:a.statusName},nativeOn:{click:function(t){return e.toOrderDetail(a.orderSn)}}},[e._l(a.items,(function(a,r){return t("van-card",{key:r,attrs:{title:a.title,desc:a.goods.descript,price:e.formatPrice(a.price),num:a.count,thumb:e.imgUrl+a.goods.pic},on:{click:function(t){return t.stopPropagation(),e.toGoods(a.goods.id)}}})})),e._v(" "),t("div",{staticClass:"total"},[e._v("合计: "+e._s(e.formatPrice(a.totalPrice))+" ")]),e._v(" "),t("div",{staticClass:"footer_btn",attrs:{slot:"footer"},slot:"footer"},[t("van-button",{directives:[{name:"show",rawName:"v-show",value:"待付款"===a.statusName,expression:"item.statusName === '待付款'"}],attrs:{size:"small",type:"default"},on:{click:function(t){return t.stopPropagation(),e.cancelOrder(a)}}},[e._v("取消订单")]),e._v(" "),t("van-button",{directives:[{name:"show",rawName:"v-show",value:"已发货"===a.statusName||"已完成"===a.statusName,expression:"item.statusName === '已发货' || item.statusName === '已完成'"}],attrs:{size:"small",type:"info"},on:{click:function(t){return t.stopPropagation(),e.viewExpressInfo(a.orderSn)}}},[e._v("查看物流")]),e._v(" "),t("van-button",{attrs:{size:"small",type:"danger"},on:{click:function(t){return t.stopPropagation(),e.handleOrder(a)}}},[e._v("\n          "+e._s(e.getHandlerText(a.statusName))+"\n        ")])],1)],2)})),1)],1),e._v(" "),t("van-tabbar",{model:{value:e.activeFooter,callback:function(t){e.activeFooter=t},expression:"activeFooter"}},[t("van-tabbar-item",{attrs:{icon:"home-o",replace:"",to:"/index"}},[e._v("首页")]),e._v(" "),t("van-tabbar-item",{attrs:{icon:"search",replace:"",to:"/search"}},[e._v("发现")]),e._v(" "),t("van-tabbar-item",{attrs:{icon:"cart-o",replace:"",to:"/cart"}},[e._v("购物车")]),e._v(" "),t("van-tabbar-item",{attrs:{icon:"user-o",replace:"",to:"/user"}},[e._v("我的")])],1)],1)},i=[],o=(a("e7e5"),a("d399")),s=a("bd86"),c=(a("66b9"),a("b650")),d=(a("2994"),a("2bdd")),u=(a("3647"),a("ea47")),l=(a("a52c"),a("2ed4")),f=(a("bda7"),a("5e46")),h=(a("537a"),a("ac28")),p=(a("da3c"),a("0b33")),m=(a("5246"),a("6b41")),g=(a("a909"),a("3acc")),v=(a("be39"),a("efa0")),b=(a("3c32"),a("417e")),k=(a("9cb7"),a("66fd")),O=(a("81e6"),a("9ffb")),j=(a("4d48"),a("d1e1")),x=a("b30f"),_="/prod-api",y={components:(r={},Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(r,j["a"].name,j["a"]),O["a"].name,O["a"]),k["a"].name,k["a"]),b["a"].name,b["a"]),v["a"].name,v["a"]),g["a"].name,g["a"]),m["a"].name,m["a"]),p["a"].name,p["a"]),h["a"].name,h["a"]),f["a"].name,f["a"]),Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(r,l["a"].name,l["a"]),u["a"].name,u["a"]),d["a"].name,d["a"]),c["a"].name,c["a"])),data:function(){return{navList:[{name:"全部",id:0},{name:"待付款",id:1},{name:"待发货",id:2},{name:"已发货",id:3},{name:"已完成",id:4}],orderList:[],activeNav:0,activeFooter:3,checkedGoods:["1"],goods:[],imgUrl:_+"/file/getImgStream?idFile=",listQuery:{page:1,limit:20,status:0},loading:!1,finished:!1}},mounted:function(){if(this.$route.query){var e=this.$route.query.status;this.activeNav=parseInt(e)-1,this.listQuery.status=e}this.init()},computed:{submitBarText:function(){var e=this.checkedGoods.length;return"结算"+(e?"(".concat(e,")"):"")}},methods:{init:function(){this.getData()},getData:function(){var e=this;x["a"].getOrders(this.listQuery).then((function(t){var a=t.data.records;for(var r in a){var n=a[r];n.title=""+n.createTime,n.descript=""+n.orderSn}e.orderList=a,e.loading=!1,e.finished=0===t.data.total||t.data.current===t.data.pages})).catch((function(e){}))},formatPrice:function(e){return(e/100).toFixed(2)},onClickLeft:function(){this.$router.go(-1)},clickNav:function(e,t){this.activeNav=e,this.listQuery.status=this.navList[e].id,this.getData()},toOrderDetail:function(e){this.$router.push("/order/detail/"+e)},toGoods:function(e){this.$router.push({path:"/goods/"+e})},cancelOrder:function(e){var t=this;x["a"].remove(e.orderSn).then((function(e){t.getData()}))},viewExpressInfo:function(e){this.$router.push("/order/expressInfo/"+e)},getHandlerText:function(e){return"已发货"===e?"确认收货":"待付款"===e?"立即付款":e},handleOrder:function(e){var t=this;"待付款"===e.statusName&&this.$router.push({path:"payment",query:{orderSn:e.orderSn,totalPrice:e.totalPrice}}),"已发货"===e.statusName&&x["a"].confirm(e.orderSn).then((function(e){Object(o["a"])("成功收货"),t.getData()}))}}},T=y,N=(a("6462"),a("2877")),w=Object(N["a"])(T,n,i,!1,null,null,null);t["default"]=w.exports},6462:function(e,t,a){"use strict";a("3cf7")},"66b9":function(e,t,a){"use strict";a("68ef"),a("9d70"),a("3743"),a("e3b3"),a("bc1b")},b30f:function(e,t,a){"use strict";var r=a("b775");t["a"]={save:function(e){return Object(r["a"])({url:"/user/order/save",method:"post",params:e})},get:function(e){return Object(r["a"])({url:"/user/order/"+e,method:"get"})},getExpressInfo:function(e){return Object(r["a"])({url:"/user/order/getExpressInfo/"+e,method:"get"})},remove:function(e){return Object(r["a"])({url:"/user/order/cancel/"+e,method:"post"})},getOrders:function(e){return Object(r["a"])({url:"/user/order/getOrders",method:"get",params:e})},prepareCheckout:function(e){return Object(r["a"])({url:"/user/order/prepareCheckout",params:e,method:"get"})},confirm:function(e){return Object(r["a"])({url:"/user/order/confirm/"+e,method:"post"})}}},b775:function(e,t,a){"use strict";a("e7e5");var r=a("d399"),n=(a("a481"),a("bc3a")),i=a.n(n),o=a("41cb"),s=a("4360"),c=a("5d2d"),d=i.a.create({baseURL:"/prod-api",withCredentials:!1,timeout:15e3});d.interceptors.request.use((function(e){return c["a"].getToken()&&(e.headers["Authorization"]=c["a"].getToken()),e}),(function(e){return Promise.reject(e)})),d.interceptors.response.use((function(e){console.log("response",e),e.headers.token&&s["a"].dispatch("app/toggleToken",e.headers.token);var t=e.data;return 2e4!==t.code?Promise.reject(t.msg||"error"):t}),(function(e){if(e.response)switch(e.response.status){case 401:return s["a"].dispatch("app/toggleUser",{}),s["a"].dispatch("app/toggleToken",""),o["a"].replace({path:"/login",query:{redirect:o["a"].currentRoute.path}}),Promise.reject(e.response.data.message);case 500:if(e.response.data.message)return e.response.data.message.indexOf("relogin")>-1?(s["a"].dispatch("app/toggleUser",{}),s["a"].dispatch("app/toggleToken",""),o["a"].replace({path:"/login",query:{redirect:o["a"].currentRoute.path}}),Promise.reject(e.response.data.message)):e.response.data.message.indexOf("该手机号已经绑定其他微信号")>-1?(s["a"].dispatch("app/toggleUser",{}),s["a"].dispatch("app/toggleToken",""),r["a"].fail(e.response.data.message),o["a"].replace({path:"/login",query:{redirect:o["a"].currentRoute.path}}),Promise.reject(e.response.data.message)):(r["a"].fail(e.response.data.message),Promise.reject(e.response.data.message));break;default:return Promise.reject(e.response.data.message)}})),t["a"]=d},c0c2:function(e,t,a){},ea47:function(e,t,a){"use strict";var r=a("2638"),n=a.n(r),i=a("d282"),o=a("ba31"),s=a("b1d2"),c=a("7744"),d=a("34e9"),u=Object(i["a"])("panel"),l=u[0],f=u[1];function h(e,t,a,r){var i=function(){return[a.header?a.header():e(c["a"],{attrs:{icon:t.icon,label:t.desc,title:t.title,value:t.status,valueClass:f("header-value")},class:f("header")}),e("div",{class:f("content")},[a.default&&a.default()]),a.footer&&e("div",{class:[f("footer"),s["e"]]},[a.footer()])]};return e(d["a"],n()([{class:f(),scopedSlots:{default:i}},Object(o["b"])(r,!0)]))}h.props={icon:String,desc:String,title:String,status:String},t["a"]=l(h)}}]);